#!/bin/bash

. $csc/scripts/cs-common

function usage() {
  echo "generate-monitor-dataset -o <output-dir> <cluster-graph-dir>"
}

check_help $1 usage

while getopts "lo:" option
do
  case $option in
    l ) logfile=$OPTARG;;
    o ) output_file=$OPTARG;;
    * ) usage; exit;;
  esac
done
shift $(( $OPTIND - 1 ))

append_classpath "CROWD_SAFE_COMMON_DIR"

main_class="edu.uci.eecs.crowdsafe.common.main.MonitorDataTransformer"

graph_dir=$1

[ -z $graph_dir ] && usage && exit
[ -z $output_file ] && usage && exit

[ -z $logfile ] && logfile="monitor-dataset.log"
echo "Logging to "$logfile

[ -d $output_file ] && output_file=${output_file%/}"/"$(basename $graph_dir)".monitor.dat"

echo "Transforming monitor data into "$output_file

#echo "java -cp $cp $main_class $@"
java -cp $cp $main_class -o $output_file $graph_dir &> $logfile

